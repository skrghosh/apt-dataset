# Caldera APT Simulation Datasets

This repository contains datasets from a series of APT (Advanced Persistent Threat) simulations conducted using [Caldera](https://caldera.mitre.org/), guided by the best practices from MITRE's [Center for Threat-Informed Defense](https://github.com/center-for-threat-informed-defense/adversary_emulation_library). The simulations represent a variety of attack scenarios, providing a rich resource for understanding the nature of sophisticated cyber threats.

## Dataset Overview

The datasets encompass multiple attack scenarios simulated in a controlled environment. Each scenario's dataset includes comprehensive logs with details of benign and malicious activities, offering invaluable insights for cybersecurity analysis.

### Campaign Details

| Campaign Name | Duration      | Attack Vector       | Records (#) | Benign (%) |
|---------------|---------------|---------------------|-------------|------------|
| APT 29        | 18h 55m       | Multiple(CALDERA)   | 3.74M       | 99.37%     |
| FIN6          | 11h 05m       | Multiple(CALDERA)   | 2.35M       | 99.69%     |
| menuPass      | 14h 35m       | Multiple(CALDERA)   | 6.34M       | 99.83%     |
| Wizard Spider | 24h 09m       | Multiple(CALDERA)   | 3.69M       | 99.78%     |
| OilRig        | 13h 16m       | Multiple(CALDERA)   | 6.19M       | 99.97%     |
| Redline       | 3h 50m        | File Execution      | 2.01M       | 99.51%     |
| Remcos        | 1h 44m        | File Execution      | 660K        | 97.47%     |
| Agent Tesla   | 6h 03m        | File Execution      | 2.69M       | 99.98%     |
| AsyncRAT      | 6h 45m        | File Execution      | 1.37M       | 99.93%     |
| Amadey        | 5h 16m        | File Execution      | 5.19M       | 99.68%     |


These datasets were generated by emulating various attack vectors as outlined by MITRE, primarily involving the CALDERA automation framework, as well as general file execution techniques. They offer an array of records ranging from hundreds of thousands to several million, with the overwhelming majority representing benign activities to provide realistic baseline behavior.

## Dataset Details

- **Total Records:** See the table above for the record count of each campaign.
- **Target System:** Windows 10 (64-bit).
- **Duration of Simulation:** Times vary per simulation campaign as detailed above.
- **Nature of Records:** Predominantly benign with a specific percentage of attacker activities, as noted in the table.
- **Data Model:** The audit logs are modeled based on MITRE's CAR (Cyber Analytics Repository) and FiveDirections' eCAR data model. [More details](https://github.com/FiveDirections/OpTC-data/blob/master/ecar.md) about the data model.


## Ground Truth

Corresponding ground truths for each scenario are included in the Ground Truth directory to facilitate validation and benchmarking efforts.


## FIN6 Campaign Tactics and Techniques

The FIN6 campaign involved a series of tactics and techniques. The table below lists each tactic, the corresponding techniques, and the abilities that were used in the simulation.

| Tactics            | Techniques                                       | Abilities                                  |
|--------------------|--------------------------------------------------|--------------------------------------------|
| Collection         | T1560.001: Archive Collected Data: Archive via Utility | fin6-25-july: Compress Files with 7zip (7.exe) |
| Credential-access  | T1003.001: OS Credential Dumping: LSASS Memory - Invoke-Mimikatz | fin6-25-july: PowerSploit Invoke-Mimikatz |
|                    | T1003.001: OS Credential Dumping: LSASS Memory - Windows Credential Editor (WCE) | fin6-25-july: WCE Credential Access      |
| Discovery          | T1087.002: Account Discovery: Domain Account    | fin6-25-july: Enumerate AD person objects |
|                    | T1018: Remote System Discovery                  | fin6-25-july: Enumerate AD computer objects |
|                    | T1482: Domain Trust Discovery                   | fin6-25-july: Enumerate AD Organizational Units |
|                    | T1016: System Network Configuration Discovery   | fin6-25-july: Enumerate AD trust objects |
|                    | T1069.002: Permission Groups Discovery: Domain Groups Units | fin6-25-july: Enumerate AD subnets, Enumerate AD groups |
| Execution          | T1569.002: System Services: Service Execution   | fin6-25-july: PsExec Remote Command |
|                    | T1047: Windows Management Instrumentation       | fin6-25-july: WMIC Remote Process Execution |
| Exfiltration       | T1041.005: Exfiltration Over C2 Channel         | fin6-25-july: Exfil staged directory |
| Privilege-escalation | T1134: Access Token Manipulation              | fin6-25-july: PowerSploit Named-Pipe Impersonation |

Please note that the techniques listed above are linked to the MITRE ATT&CK framework, which details a comprehensive matrix of tactics and techniques used by threat actors in real-world cyber attacks.



## Usage

These datasets are versatile, suited for:
- **Research:** Understand APT behaviors and patterns.
- **Machine Learning:** Train models to differentiate between benign and malicious actions.
- **Benchmarking:** Evaluate the effectiveness of security systems against simulated APT attacks.

---

**Anonymization Update:**
We are currently in the process of anonymizing the dataset to remove identifiable keywords. This will be completed in the upcoming weeks.

---

## License

This dataset is made available under the Creative Commons Attribution 4.0 International license (CC BY 4.0). You are free to share and adapt this dataset for any purpose, even commercially, as long as you provide appropriate credit, provide a link to the license, and indicate if changes were made.

When citing this dataset, please use the following format:

> [Name of Authors]. Citar: Cyberthreat Intelligence-driven Attack Reconstruction. [Online].

A full copy of the license can be found [here](https://creativecommons.org/licenses/by/4.0/).


## Acknowledgements

Special thanks to MITRE and the Caldera team for their guidance in creating these simulations.

---

For any discrepancies found in the datasets or inquiries about their use, please open an issue in this repository. Contributions and suggestions are always appreciated!
